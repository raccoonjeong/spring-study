# 4. 리다이렉트 redirect

## 1. 리다이렉트란?

웹에서 리다이렉트는 사용자가 특정 주소로 들어왔을 때, 조건에 따라 다른 주소로 강제로 이동시키는 것을 의미합니다.

React Router에서는 이 기능을 활용해 로그인 제어, 잘못된 주소 처리, 옛 주소를 새 주소로 바꾸기 등에 사용합니다.

## 2. React Router v6 리다이렉트 방법

### (1) <Navigate />

JSX 안에서 조건부 렌더링으로 사용.

```jsx
import { Navigate } from "react-router-dom";

function PrivateRoute({ children }) {
  const isLogin = false; // 로그인 여부(예시)

  if (!isLogin) {
    return <Navigate to="/login" replace />;
  }
  return children;
}
```

- to="/login" → 이동할 주소

- replace → 브라우저 기록을 덮어씀 (뒤로 가기 방지)

## (2) useNavigate() 훅

이벤트나 로직 안에서 프로그래밍 방식으로 이동.

```jsx
import { useNavigate } from "react-router-dom";

function Home() {
  const navigate = useNavigate();

  const goLogin = () => {
    navigate("/login");
  };

  return (
    <div>
      <h1>Home Page</h1>
      <button onClick={goLogin}>로그인 페이지로 이동</button>
    </div>
  );
}
```

## 3. state와 navigate

리다이렉트할 때 state를 함께 넘길 수 있습니다.

```js
navigate("/result", {
  state: { msg: "저장 성공!", time: Date.now() },
});
```

- state에 저장 가능한 값: 숫자, 문자열, 불리언, 객체, 배열 등 직렬화 가능한 데이터.

- 불가능/권장하지 않음: 함수, DOM, 클래스 인스턴스.

- 주의: 새로고침하면 state는 사라집니다.

```jsx
import { useLocation } from "react-router-dom";

function ResultPage() {
  const location = useLocation();
  return <h2>{location.state?.msg}</h2>;
}
```

state는 일시적인 UI 흐름 제어용.

중요한 데이터라면 전역 상태나 쿼리 스트링으로 관리하는 것이 안전합니다.

## 4. 예전 URL을 새 URL로 리다이렉트

서비스를 운영하다 보면 /old-page 같은 옛 주소를 /new-page로 바꿔야 할 때가 있습니다.

이때는 라우트에서 <Navigate />를 직접 써서 처리합니다.

```jsx
import { Routes, Route, Navigate } from "react-router-dom";
import NewPage from "./NewPage";

function App() {
  return (
    <Routes>
      <Route path="/new-page" element={<NewPage />} />
      {/* 예전 주소 → 새 주소 리다이렉트 */}
      <Route path="/old-page" element={<Navigate to="/new-page" replace />} />
      {/* 잘못된 모든 주소 → 홈으로 */}
      <Route path="*" element={<Navigate to="/" replace />} />
    </Routes>
  );
}
```

사용자가 /old-page로 들어오면 자동으로 /new-page로 리다이렉트됩니다.

replace 옵션을 주면 뒤로 가기 눌러도 /old-page로 안 돌아가고 바로 /new-page로만 유지됩니다.

## 5.다양한 활용 예시

- 로그인 필요 페이지 → 로그인 안 했을 때 /login으로 리다이렉트

- /old-page 접근 시 /new-page로 이동

- 잘못된 주소 → / 홈으로 이동

- 글 작성 완료 시 /posts 목록으로 이동

## 6. 정리

- 리다이렉트는 조건부 이동으로 UX를 보호하는 중요한 기능.

- Navigate → JSX 조건부 이동

- useNavigate → 이벤트/코드 안에서 이동

- state → 직렬화 가능한 값은 다 넣을 수 있지만, 새로고침 시 사라짐

- 옛 주소 처리 → <Route path="/old" element={<Navigate to="/new" replace />} />
