# react-router-dom 정리하기

## 1. react-router-dom 설치

### npm으로 설치하기

```
# npm 사용시
npm i react-router-dom
```

### 엔트리 구성

```jsx
// main.jsx
import React from "react";
import ReactDOM from "react-dom/client";
import { BrowserRouter } from "react-router-dom";
import App from "./App";

ReactDOM.createRoot(document.getElementById("root")).render(
  <BrowserRouter>
    <App />
  </BrowserRouter>
);
```

## 2. 기본 라우팅: Routes / Route

```jsx
// App.jsx
import { Routes, Route, Link } from "react-router-dom";
import Home from "./pages/Home";
import About from "./pages/About";
import NotFound from "./pages/NotFound";

export default function App() {
  return (
    <div>
      <nav>
        <Link to="/">홈</Link>
        {" | "}
        <Link to="/about">소개</Link>
      </nav>

      <Routes>
        <Route path="/" element={<Home />} />
        <Route path="about" element={<About />} />
        {/* 404 */}
        <Route path="*" element={<NotFound />} />
      </Routes>
    </div>
  );
}
```

### 404 페이지 (NotFound)

와일드카드(\*)를 사용해서 404 페이지를 표기할 수 있습니다.

```jsx
<Route path="*" element={<NotFound />} />
```

#### NotFound.jsx

```jsx
// pages/NotFound.jsx
export default function NotFound() {
  return <h2>페이지를 찾을 수 없습니다.</h2>;
}
```

## 3. 네비게이션 링크 - Link, NavLink

### Link

a 태그 대체. 새로고침 없이 클라이언트 내비게이션 수행.

```jsx
<Link to="/about">소개</Link>
```

### NavLink

“활성 라우트”에 스타일을 주고 싶을 때.

```jsx
import { NavLink } from "react-router-dom";

<NavLink to="/about" className={({ isActive }) => (isActive ? "active" : "")}>
  소개
</NavLink>;
```

#### NavLink 예시

```jsx
import { NavLink } from "react-router-dom";
import "Navbar.css";

export default function Navbar() {
  return (
    <nav className="Navbar">
      <NavLink
        to="/"
        end
        className={({ isActive }) => (isActive ? "active" : undefined)}
      >
        홈
      </NavLink>

      <NavLink
        to="/about"
        className={({ isActive }) => (isActive ? "active" : undefined)}
      >
        소개
      </NavLink>

      <NavLink
        to="/contact"
        className={({ isActive }) => (isActive ? "active" : undefined)}
      >
        문의
      </NavLink>
    </nav>
  );
}
```

#### CSS (Navbar.css)

```css
nav.Navbar {
  display: flex;
  gap: 12px;
  padding: 10px 20px;
  background: #fafafa;
  border-bottom: 1px solid #ddd;
}

nav.Navbar a {
  color: #555;
  text-decoration: none;
  padding: 6px 12px;
  border-radius: 4px;
  transition: background 0.2s, color 0.2s;
}

nav.Navbar a:hover {
  background: #eee;
  color: #222;
}

/* NavLink가 active일 때 적용 */
nav.Navbar a.active {
  background: #333;
  color: #fff;
  font-weight: bold;
}
```

## 4. URL 파라미터 & 쿼리

### 동적 세그먼트: useParams

```jsx
<Route path="/posts/:postId" element={<PostDetail />} />
```

```jsx
// url "/posts/:postId"
import { useParams } from "react-router-dom";

function PostDetail() {
  const { postId } = useParams();
  return <h2>Post #{postId}</h2>;
}
```

### 쿼리스트링: useSearchParams

```jsx
import { useSearchParams } from "react-router-dom";

function SearchPage() {
  const [params, setParams] = useSearchParams();
  const q = params.get("q") || "";

  return (
    <div>
      <input
        value={q}
        onChange={(e) => setParams({ q: e.target.value })}
        placeholder="검색어"
      />
      <p>검색어: {q}</p>
    </div>
  );
}
```

## 5. 레이아웃: Outlet, index 라우트

### 레이아웃 사용하기

```jsx
// App.jsx
import { Routes, Route } from "react-router-dom";
import Layout from "./Layout";
import Home from "./pages/Home";
import About from "./pages/About";
import Profile from "./pages/Profile";

export default function App() {
  return (
    <Routes>
      {/* Layout을 부모로 */}
      <Route path="/" element={<Layout />}>
        <Route index element={<Home />} /> {/* / */}
        <Route path="about" element={<About />} /> {/* /about */}
        <Route path="profile" element={<Profile />} /> {/* /profile */}
      </Route>
    </Routes>
  );
}
```

### Outlet 컴포넌트

자식 라우트의 자리를 <Outlet> 컴포넌트로 표기합니다.

```jsx
// Layout.jsx
import { Link, Outlet } from "react-router-dom";

export default function Layout() {
  return (
    <div>
      <header>
        <h1>My Website</h1>
        <nav>
          <Link to="/">홈</Link> | <Link to="/about">소개</Link> |{" "}
          <Link to="/profile">프로필</Link>
        </nav>
      </header>

      <main>
        {/* 자식 라우트가 이 위치에 표시됨 */}
        <Outlet />
      </main>

      <footer>© 2025 Footer</footer>
    </div>
  );
}
```

즉, Layout의 헤더/푸터는 항상 고정이고, <Outlet /> 위치에 해당 자식 페이지가 교체되어 들어옵니다.

### 6. 중첩 라우트

#### App.jsx

```jsx
// App.jsx
import { Routes, Route } from "react-router-dom";
import Layout from "./Layout";
import DashboardLayout from "./pages/dashboard/DashboardLayout";
import DashboardHome from "./pages/dashboard/DashboardHome";
import UserList from "./pages/dashboard/UserList";
import UserDetail from "./pages/dashboard/UserDetail";
import Home from "./pages/Home";

export default function App() {
  return (
    <Routes>
      {/* 최상위 레이아웃 */}
      <Route path="/" element={<Layout />}>
        <Route index element={<Home />} />

        {/* 대시보드 중첩 라우트 */}
        <Route path="dashboard" element={<DashboardLayout />}>
          <Route index element={<DashboardHome />} /> {/* /dashboard */}
          <Route path="users" element={<UserList />} /> {/* /dashboard/users */}
          <Route path="users/:id" element={<UserDetail />} />{" "}
          {/* /dashboard/users/10 */}
        </Route>
      </Route>
    </Routes>
  );
}
```

#### DashboardLayout.jsx

```jsx
// /pages/DashboardLayout.jsx
import { Link, Outlet } from "react-router-dom";

export default function DashboardLayout() {
  return (
    <div>
      <h2>대시보드</h2>
      <nav>
        <Link to="/dashboard">홈</Link> |{" "}
        <Link to="/dashboard/users">유저 목록</Link>
      </nav>
      <hr />
      {/* 자식 라우트 표시 */}
      <Outlet />
    </div>
  );
}
```

## 6. 리다이렉트: Navigate, useNavigate

### <Navigate />

조건부 렌더링 시점에 자동 리다이렉트

```jsx
// Home.jsx
import { Navigate } from "react-router-dom";

export default function Home() {
  const isLogin = false; // 로그인 여부 (예시)

  if (!isLogin) {
    // 로그인 안 된 경우 → 바로 /login 으로 리다이렉트
    return <Navigate to="/login" replace />;
  }

  return <h2>홈 화면 (로그인됨)</h2>;
}
```

- 장점: 코드 간단, 조건만 있으면 바로 처리

- 단점: 렌더링 시점에 무조건 실행 → “버튼 눌러서 이동” 같은 제어는 불가능

### useNavigate

사용자 이벤트(버튼 클릭)로 이동

```jsx
// Home.jsx
import { useNavigate } from "react-router-dom";

export default function Home() {
  const navigate = useNavigate();
  const isLogin = false;

  const handleCheck = () => {
    if (!isLogin) {
      navigate("/login", { replace: true }); // 버튼 누를 때 이동
    }
  };

  return (
    <div>
      <h2>홈 화면</h2>
      <button onClick={handleCheck}>로그인 확인 후 이동</button>
    </div>
  );
}
```

- 장점: 이벤트·함수 실행 타이밍을 내가 직접 제어 가능

- 단점: JSX 조건부 리다이렉트처럼 간단하지는 않음

### 비교하기

- **자동/조건부 이동**: <Navigate />

- **버튼 클릭 등 이벤트 기반 이동**: useNavigate()

## 7. 상대/절대 경로 이동 팁

라우트 안에서 to="..", to="../sibling" 같이 상대 경로 사용 가능.

여러 중첩에서 상위로 이동할 때 유용.

### 상위 경로로 이동 (parent)

```jsx
<Link to="..">상위로</Link>
```

### 형제 경로로 이동 (sibling)

```jsx
<Link to="../users">형제 users</Link>
```

## 8. 스크롤 복원 (ScrollToTop)

React Router v6는 기본 스크롤 복원 기능이 없으므로, 라우트 변경 시 최상단 이동을 직접 처리해야 합니다.

### ScrollToTop.jsx

```jsx
// ScrollToTop.jsx
import { useEffect } from "react";
import { useLocation } from "react-router-dom";

export function ScrollToTop() {
  const { pathname } = useLocation();
  useEffect(() => {
    window.scrollTo({ top: 0, behavior: "instant" });
  }, [pathname]);
  return null;
}
```

### main.jsx

```jsx
// main.jsx 또는 Layout 상단에 배치
<BrowserRouter>
  <ScrollToTop />
  <App />
</BrowserRouter>
```
